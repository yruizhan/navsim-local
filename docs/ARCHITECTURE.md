# NavSim Local æ¶æ„è®¾è®¡æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» NavSim Local çš„æ¶æ„è®¾è®¡ã€æ’ä»¶åŠ è½½æœºåˆ¶å’Œå…³é”®è®¾è®¡å†³ç­–ã€‚

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [ä¸‰å±‚è§£è€¦æ¶æ„](#ä¸‰å±‚è§£è€¦æ¶æ„)
- [æ’ä»¶åŠ è½½æœºåˆ¶](#æ’ä»¶åŠ è½½æœºåˆ¶)
- [æ•°æ®æµ](#æ•°æ®æµ)
- [å…³é”®è®¾è®¡å†³ç­–](#å…³é”®è®¾è®¡å†³ç­–)
- [æ€§èƒ½è€ƒè™‘](#æ€§èƒ½è€ƒè™‘)

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NavSim Local Application                  â”‚
â”‚  (ä¸»ç¨‹åº - åœºæ™¯åŠ è½½ã€æ’ä»¶ç®¡ç†ã€ä»¿çœŸæ‰§è¡Œ)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Plugin Framework                          â”‚
â”‚  (æ’ä»¶æ¡†æ¶ - åŠ¨æ€åŠ è½½ã€æ³¨å†Œè¡¨ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†)                  â”‚
â”‚  - DynamicPluginLoader                                       â”‚
â”‚  - PlannerPluginRegistry                                     â”‚
â”‚  - PerceptionPluginRegistry                                  â”‚
â”‚  - PlannerPluginManager                                      â”‚
â”‚  - PerceptionPluginManager                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Perception Plugins      â”‚  â”‚  Planner Plugins         â”‚
â”‚  (æ„ŸçŸ¥æ’ä»¶)              â”‚  â”‚  (è§„åˆ’å™¨æ’ä»¶)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GridMapBuilder           â”‚  â”‚ StraightLinePlanner      â”‚
â”‚ EsdfBuilder              â”‚  â”‚ AstarPlanner             â”‚
â”‚ ...                      â”‚  â”‚ JpsPlanner               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | èŒè´£ | ä½ç½® |
|------|------|------|
| **Platform Layer** | æ’ä»¶æ¥å£ã€æ•°æ®ç»“æ„ã€æ¡†æ¶ | `platform/` |
| **Plugin Framework** | æ’ä»¶åŠ è½½ã€æ³¨å†Œã€ç®¡ç† | `platform/src/plugin/` |
| **Plugins** | å…·ä½“ç®—æ³•å®ç° | `plugins/` |
| **Development Tools** | è„šæ‰‹æ¶ã€åœºæ™¯ç”Ÿæˆã€æµ‹è¯• | `tools/` |
| **Applications** | ä¸»ç¨‹åºå’Œä»¿çœŸå™¨ | `apps/` |

## ğŸ¯ ä¸‰å±‚è§£è€¦æ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Platform Layer                        â”‚
â”‚  (å¹³å°å±‚ - æ’ä»¶æ¡†æ¶ã€æ•°æ®ç»“æ„ã€æ¥å£å®šä¹‰)                  â”‚
â”‚                                                          â”‚
â”‚  æ ¸å¿ƒæ¥å£:                                                â”‚
â”‚  - PlannerPluginInterface                                â”‚
â”‚  - PerceptionPluginInterface                             â”‚
â”‚                                                          â”‚
â”‚  æ•°æ®ç»“æ„:                                                â”‚
â”‚  - PlanningContext (è¾“å…¥)                                â”‚
â”‚  - PlanningResult (è¾“å‡º)                                 â”‚
â”‚  - OccupancyGrid, ESDFMap (æ„ŸçŸ¥æ•°æ®)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–²
                            â”‚ å®ç°æ¥å£
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Adapter Layer                         â”‚
â”‚  (é€‚é…å±‚ - å¹³å°æ¥å£é€‚é…)                                  â”‚
â”‚                                                          â”‚
â”‚  èŒè´£:                                                    â”‚
â”‚  - å®ç°å¹³å°æ’ä»¶æ¥å£                                       â”‚
â”‚  - æ•°æ®æ ¼å¼è½¬æ¢ (å¹³å° â†” ç®—æ³•)                            â”‚
â”‚  - é…ç½®åŠ è½½ (JSON â†’ ç®—æ³•å‚æ•°)                            â”‚
â”‚  - é”™è¯¯å¤„ç†å’Œæ—¥å¿—                                         â”‚
â”‚                                                          â”‚
â”‚  ç¤ºä¾‹:                                                    â”‚
â”‚  - AstarPlannerPlugin::plan()                            â”‚
â”‚  - GridMapAdapter (é€‚é…å™¨æ¨¡å¼)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–²
                            â”‚ è°ƒç”¨ç®—æ³•
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Algorithm Layer                        â”‚
â”‚  (ç®—æ³•å±‚ - çº¯ç®—æ³•å®ç°)                                    â”‚
â”‚                                                          â”‚
â”‚  ç‰¹ç‚¹:                                                    â”‚
â”‚  - åªä¾èµ– Eigen + STL                                    â”‚
â”‚  - æ— å¹³å°ä¾èµ–ï¼Œå¯ç‹¬ç«‹æµ‹è¯•                                 â”‚
â”‚  - å¯å¤ç”¨åˆ°å…¶ä»–é¡¹ç›®                                       â”‚
â”‚  - ä¸å¤„ç† JSON                                           â”‚
â”‚                                                          â”‚
â”‚  ç¤ºä¾‹:                                                    â”‚
â”‚  - AstarPlanner::plan(start, goal)                       â”‚
â”‚  - GridMapInterface (æŠ½è±¡æ¥å£)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å±‚æ¬¡èŒè´£

#### Platform Layerï¼ˆå¹³å°å±‚ï¼‰

**èŒè´£**ï¼š
- å®šä¹‰æ’ä»¶æ¥å£ï¼ˆ`PlannerPluginInterface`, `PerceptionPluginInterface`ï¼‰
- æä¾›æ ‡å‡†åŒ–æ•°æ®ç»“æ„ï¼ˆ`PlanningContext`, `PlanningResult`ï¼‰
- ç®¡ç†æ’ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆåŠ è½½ã€åˆå§‹åŒ–ã€å¸è½½ï¼‰
- æä¾›æ’ä»¶æ³¨å†Œè¡¨ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰

**å…³é”®æ–‡ä»¶**ï¼š
- `platform/include/plugin/framework/planner_plugin_interface.hpp`
- `platform/include/plugin/framework/perception_plugin_interface.hpp`
- `platform/include/core/planning_context.hpp`
- `platform/include/plugin/data/planning_result.hpp`

#### Adapter Layerï¼ˆé€‚é…å±‚ï¼‰

**èŒè´£**ï¼š
- å®ç°å¹³å°æ’ä»¶æ¥å£
- æ•°æ®æ ¼å¼è½¬æ¢ï¼ˆå¹³å°æ•°æ®ç»“æ„ â†” ç®—æ³•æ•°æ®ç»“æ„ï¼‰
- é…ç½®åŠ è½½ï¼ˆJSON â†’ ç®—æ³•å‚æ•°ï¼‰
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º

**ç¤ºä¾‹**ï¼š
```cpp
// é€‚é…å™¨å®ç°å¹³å°æ¥å£
class AstarPlannerPlugin : public navsim::plugin::PlannerPluginInterface {
public:
  bool plan(
      const navsim::planning::PlanningContext& context,  // å¹³å°æ•°æ®
      std::chrono::milliseconds deadline,
      navsim::plugin::PlanningResult& result) override {
    
    // 1. æå–æ•°æ®
    Eigen::Vector3d start(context.ego.pose.x, context.ego.pose.y, context.ego.pose.yaw);
    Eigen::Vector3d goal(context.task.goal_pose.x, context.task.goal_pose.y, context.task.goal_pose.yaw);
    
    // 2. è°ƒç”¨ç®—æ³•
    auto algo_result = planner_->plan(start, goal);  // ç®—æ³•æ•°æ®
    
    // 3. è½¬æ¢è¾“å‡º
    convertAlgorithmOutputToResult(algo_result, result);
    
    return result.success;
  }
};
```

#### Algorithm Layerï¼ˆç®—æ³•å±‚ï¼‰

**èŒè´£**ï¼š
- çº¯ç®—æ³•å®ç°
- åªä¾èµ– Eigen å’Œ STL
- æ— å¹³å°ä¾èµ–
- å¯ç‹¬ç«‹ç¼–è¯‘å’Œæµ‹è¯•

**ç¤ºä¾‹**ï¼š
```cpp
// ç®—æ³•å±‚åªä¾èµ– Eigen
class AstarPlanner {
public:
  Result plan(
      const Eigen::Vector3d& start,
      const Eigen::Vector3d& goal) {
    // çº¯ç®—æ³•å®ç°
    // ä¸ä¾èµ–å¹³å° API
    // ä¸å¤„ç† JSON
  }
};
```

## ğŸ”Œ æ’ä»¶åŠ è½½æœºåˆ¶

### åŒé‡æ³¨å†Œæœºåˆ¶

ä¸ºäº†åŒæ—¶æ”¯æŒ**åŠ¨æ€åŠ è½½**å’Œ**é™æ€é“¾æ¥**ï¼Œç³»ç»Ÿé‡‡ç”¨åŒé‡æ³¨å†Œæœºåˆ¶ï¼š

#### 1. åŠ¨æ€æ³¨å†Œï¼ˆé€šè¿‡ dlsymï¼‰

```cpp
// adapter/register.cpp
extern "C" {
void registerAstarPlannerPlugin() {
  navsim::plugin::PlannerPluginRegistry::getInstance().registerPlugin(
      "AstarPlanner",
      []() -> std::shared_ptr<navsim::plugin::PlannerPluginInterface> {
        return std::make_shared<AstarPlannerPlugin>();
      });
}
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- ç”¨æˆ·å¼€å‘çš„å¤–éƒ¨æ’ä»¶
- é€šè¿‡ `--planner /path/to/plugin.so` åŠ è½½

#### 2. é™æ€æ³¨å†Œï¼ˆé€šè¿‡é™æ€åˆå§‹åŒ–å™¨ï¼‰

```cpp
// adapter/register.cpp
namespace {
struct AstarPlannerPluginRegistrar {
  AstarPlannerPluginRegistrar() {
    registerAstarPlannerPlugin();
  }
};
static AstarPlannerPluginRegistrar registrar;
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- å†…ç½®æ’ä»¶
- ç¼–è¯‘æ—¶é™æ€é“¾æ¥åˆ°ä¸»ç¨‹åº

### æ’ä»¶åŠ è½½æµç¨‹

```
1. åˆå§‹åŒ–æ’ä»¶ç³»ç»Ÿ
   â””â”€> initializeAllPlugins()
       â””â”€> loadAllBuiltinPlugins()  // é™æ€æ³¨å†Œæ‰€æœ‰å†…ç½®æ’ä»¶

2. åŠ è½½æ’ä»¶
   â”œâ”€> DynamicPluginLoader::loadPlugin("AstarPlanner", "")
   â”‚   â”œâ”€> æŸ¥æ‰¾æ’ä»¶åº“æ–‡ä»¶
   â”‚   â”‚   â””â”€> findPluginLibrary("AstarPlanner")
   â”‚   â”‚       â””â”€> "plugins/planning/astar_planner/libastar_planner_plugin.so"
   â”‚   â”œâ”€> åŠ¨æ€åŠ è½½åº“
   â”‚   â”‚   â””â”€> dlopen(library_path, RTLD_NOW | RTLD_GLOBAL)
   â”‚   â””â”€> è°ƒç”¨æ³¨å†Œå‡½æ•°
   â”‚       â””â”€> dlsym(handle, "registerAstarPlannerPlugin")
   â”‚           â””â”€> æ³¨å†Œåˆ° PlannerPluginRegistry
   â”‚
   â””â”€> æ’ä»¶å·²æ³¨å†Œåˆ°æ³¨å†Œè¡¨

3. åˆ›å»ºæ’ä»¶å®ä¾‹
   â””â”€> PlannerPluginRegistry::getInstance().createPlugin("AstarPlanner")
       â””â”€> è°ƒç”¨å·¥å‚å‡½æ•°åˆ›å»ºå®ä¾‹
```

### ç»Ÿä¸€è·¯å¾„è§£æ

æ”¯æŒä¸¤ç§åŠ è½½æ–¹å¼ï¼š

#### 1. çŸ­åç§°ï¼ˆæ¨èï¼‰

```bash
--planner AstarPlanner
```

ç³»ç»Ÿè‡ªåŠ¨æŸ¥æ‰¾ï¼š
1. `plugins/planning/astar_planner/libastar_planner_plugin.so`
2. `plugins/planning/libastar_planner_plugin.so`
3. `build/plugins/planning/astar_planner/libastar_planner_plugin.so`

#### 2. å®Œæ•´è·¯å¾„

```bash
--planner /path/to/my_custom_planner/build/libmy_planner.so
```

ç›´æ¥åŠ è½½æŒ‡å®šè·¯å¾„çš„æ’ä»¶ã€‚

## ğŸ“Š æ•°æ®æµ

### è§„åˆ’æµç¨‹

```
1. åŠ è½½åœºæ™¯
   â””â”€> ScenarioLoader::loadFromFile("scenario.json")
       â””â”€> PlanningContext

2. è¿è¡Œæ„ŸçŸ¥æ’ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰
   â””â”€> PerceptionPluginManager::process(input, context)
       â”œâ”€> GridMapBuilder::process()
       â”‚   â””â”€> context.occupancy_grid = ...
       â””â”€> EsdfBuilder::process()
           â””â”€> context.esdf_map = ...

3. è¿è¡Œè§„åˆ’å™¨
   â””â”€> PlannerPluginManager::plan(context, deadline, result)
       â””â”€> AstarPlanner::plan(context, deadline, result)
           â”œâ”€> æ£€æŸ¥ä¾èµ–: context.occupancy_grid
           â”œâ”€> åˆ›å»ºé€‚é…å™¨: GridMapAdapter
           â”œâ”€> è°ƒç”¨ç®—æ³•: planner_->plan(start, goal)
           â””â”€> è½¬æ¢è¾“å‡º: convertAlgorithmOutputToResult()

4. è¾“å‡ºç»“æœ
   â””â”€> PlanningResult
       â”œâ”€> success
       â”œâ”€> trajectory
       â”œâ”€> computation_time_ms
       â””â”€> failure_reason
```

### æ•°æ®ç»“æ„

#### PlanningContextï¼ˆè¾“å…¥ï¼‰

```cpp
struct PlanningContext {
  EgoVehicle ego;                                    // è‡ªè½¦çŠ¶æ€
  PlanningTask task;                                 // è§„åˆ’ä»»åŠ¡
  std::unique_ptr<OccupancyGrid> occupancy_grid;     // æ …æ ¼åœ°å›¾ï¼ˆå¯é€‰ï¼‰
  std::unique_ptr<ESDFMap> esdf_map;                 // ESDF åœ°å›¾ï¼ˆå¯é€‰ï¼‰
  std::unique_ptr<BEVObstacles> bev_obstacles;       // BEV éšœç¢ç‰©ï¼ˆå¯é€‰ï¼‰
  std::vector<DynamicObstacle> dynamic_obstacles;    // åŠ¨æ€éšœç¢ç‰©
  double timestamp;                                  // æ—¶é—´æˆ³
};
```

#### PlanningResultï¼ˆè¾“å‡ºï¼‰

```cpp
struct PlanningResult {
  bool success;                                      // æ˜¯å¦æˆåŠŸ
  std::string failure_reason;                        // å¤±è´¥åŸå› 
  std::vector<TrajectoryPoint> trajectory;           // è½¨è¿¹
  double computation_time_ms;                        // è®¡ç®—æ—¶é—´
  double total_cost;                                 // æ€»ä»£ä»·
  nlohmann::json debug_info;                         // è°ƒè¯•ä¿¡æ¯
};
```

## ğŸ¨ å…³é”®è®¾è®¡å†³ç­–

### 1. ä¸ºä»€ä¹ˆé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼Ÿ

**é—®é¢˜**ï¼šå¦‚ä½•åœ¨ä¿æŒç®—æ³•å¯å¤ç”¨æ€§çš„åŒæ—¶ï¼Œæ”¯æŒçµæ´»çš„æ’ä»¶ç³»ç»Ÿï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šä¸‰å±‚è§£è€¦æ¶æ„

**ä¼˜ç‚¹**ï¼š
- âœ… ç®—æ³•å±‚å¯ç‹¬ç«‹æµ‹è¯•å’Œå¤ç”¨
- âœ… é€‚é…å±‚éš”ç¦»å¹³å°å˜åŒ–
- âœ… å¹³å°å±‚æä¾›ç»Ÿä¸€æ¥å£

**ç¤ºä¾‹**ï¼š
- ç®—æ³•å±‚çš„ `AstarPlanner` å¯ä»¥åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨
- åªéœ€é‡æ–°å®ç°é€‚é…å±‚å³å¯

### 2. ä¸ºä»€ä¹ˆä½¿ç”¨åŒé‡æ³¨å†Œæœºåˆ¶ï¼Ÿ

**é—®é¢˜**ï¼šå¦‚ä½•åŒæ—¶æ”¯æŒå†…ç½®æ’ä»¶ï¼ˆé™æ€é“¾æ¥ï¼‰å’Œå¤–éƒ¨æ’ä»¶ï¼ˆåŠ¨æ€åŠ è½½ï¼‰ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šåŒé‡æ³¨å†Œæœºåˆ¶

**ä¼˜ç‚¹**ï¼š
- âœ… å†…ç½®æ’ä»¶è‡ªåŠ¨æ³¨å†Œï¼ˆé™æ€åˆå§‹åŒ–å™¨ï¼‰
- âœ… å¤–éƒ¨æ’ä»¶åŠ¨æ€åŠ è½½ï¼ˆdlsymï¼‰
- âœ… ç»Ÿä¸€çš„æ³¨å†Œè¡¨æ¥å£

### 3. ä¸ºä»€ä¹ˆæ„ŸçŸ¥æ’ä»¶å’Œè§„åˆ’å™¨åˆ†ç¦»ï¼Ÿ

**é—®é¢˜**ï¼šæ„ŸçŸ¥å¤„ç†åº”è¯¥åœ¨è§„åˆ’å™¨å†…éƒ¨è¿˜æ˜¯ç‹¬ç«‹æ’ä»¶ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šç‹¬ç«‹çš„æ„ŸçŸ¥æ’ä»¶

**ä¼˜ç‚¹**ï¼š
- âœ… å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰
- âœ… æ„ŸçŸ¥ç®—æ³•å¯å¤ç”¨
- âœ… è§„åˆ’å™¨å¯å£°æ˜ä¾èµ–
- âœ… çµæ´»ç»„åˆä¸åŒæ„ŸçŸ¥å’Œè§„åˆ’ç®—æ³•

**ç¤ºä¾‹**ï¼š
```cpp
// è§„åˆ’å™¨å£°æ˜ä¾èµ–
metadata.required_perception_data = {"occupancy_grid"};

// å¹³å°è‡ªåŠ¨åŠ è½½ GridMapBuilder
// æˆ–ç”¨æˆ·æ‰‹åŠ¨æŒ‡å®š: --perception GridMapBuilder
```

### 4. ä¸ºä»€ä¹ˆä½¿ç”¨ Eigen è€Œä¸æ˜¯è‡ªå®šä¹‰æ•°æ®ç»“æ„ï¼Ÿ

**é—®é¢˜**ï¼šç®—æ³•å±‚åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ Eigen

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸šç•Œæ ‡å‡†ï¼Œå¹¿æ³›ä½¿ç”¨
- âœ… é«˜æ€§èƒ½ï¼ˆSIMD ä¼˜åŒ–ï¼‰
- âœ… ä¸°å¯Œçš„æ•°å­¦è¿ç®—
- âœ… Header-onlyï¼Œæ˜“äºé›†æˆ

### 5. ä¸ºä»€ä¹ˆé€‚é…å™¨ä¸­æ‰‹åŠ¨å®ç°åæ ‡è½¬æ¢ï¼Ÿ

**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥è°ƒç”¨ `OccupancyGrid::worldToCell()`ï¼Ÿ

**åŸå› **ï¼šåŠ¨æ€åŠ è½½çš„æ’ä»¶æ— æ³•è®¿é—®å¹³å°åº“å‡½æ•°

**è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨é€‚é…å™¨ä¸­æ‰‹åŠ¨å®ç°ç®€å•çš„è½¬æ¢é€»è¾‘

```cpp
// ä¸è¦è¿™æ ·ï¼ˆä¼šå¯¼è‡´é“¾æ¥é”™è¯¯ï¼‰
auto [gx, gy] = grid->worldToCell({x, y});

// åº”è¯¥è¿™æ ·ï¼ˆæ‰‹åŠ¨å®ç°ï¼‰
int gx = static_cast<int>((x - grid->config.origin.x) / grid->config.resolution);
int gy = static_cast<int>((y - grid->config.origin.y) / grid->config.resolution);
```

## âš¡ æ€§èƒ½è€ƒè™‘

### 1. æ’ä»¶åŠ è½½æ€§èƒ½

- **åŠ¨æ€åŠ è½½å¼€é”€**ï¼š~1-5 msï¼ˆé¦–æ¬¡åŠ è½½ï¼‰
- **é™æ€é“¾æ¥å¼€é”€**ï¼š0 msï¼ˆç¼–è¯‘æ—¶é“¾æ¥ï¼‰
- **å»ºè®®**ï¼šå†…ç½®æ’ä»¶ä½¿ç”¨é™æ€é“¾æ¥ï¼Œå¤–éƒ¨æ’ä»¶ä½¿ç”¨åŠ¨æ€åŠ è½½

### 2. æ•°æ®è½¬æ¢å¼€é”€

- **Eigen â†” å¹³å°æ•°æ®ç»“æ„**ï¼š~0.01 msï¼ˆå°è§„æ¨¡æ•°æ®ï¼‰
- **ä¼˜åŒ–**ï¼šä½¿ç”¨ `std::move` é¿å…æ‹·è´

### 3. å†…å­˜ç®¡ç†

- **æ™ºèƒ½æŒ‡é’ˆ**ï¼šä½¿ç”¨ `std::unique_ptr` å’Œ `std::shared_ptr`
- **é¿å…æ‹·è´**ï¼šä½¿ç”¨ `const&` ä¼ é€’å¤§å¯¹è±¡
- **é¢„åˆ†é…**ï¼šé¢„åˆ†é…å®¹å™¨å¤§å°

### 4. å¹¶å‘è€ƒè™‘

- **æ’ä»¶æ³¨å†Œè¡¨**ï¼šçº¿ç¨‹å®‰å…¨ï¼ˆå•ä¾‹æ¨¡å¼ + äº’æ–¥é”ï¼‰
- **æ’ä»¶å®ä¾‹**ï¼šæ¯ä¸ªå®ä¾‹ç‹¬ç«‹ï¼Œæ— å…±äº«çŠ¶æ€
- **å»ºè®®**ï¼šå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºç‹¬ç«‹çš„æ’ä»¶å®ä¾‹

## ğŸ“š å‚è€ƒèµ„æ–™

- [å¿«é€Ÿå¼€å§‹æŒ‡å—](GETTING_STARTED.md)
- [æ’ä»¶å¼€å‘æŒ‡å—](PLUGIN_DEVELOPMENT.md)
- [å¼€å‘å·¥å…·æŒ‡å—](DEVELOPMENT_TOOLS.md)

## ğŸ” æ·±å…¥é˜…è¯»

### æ’ä»¶ç³»ç»Ÿå®ç°

- `platform/src/plugin/framework/dynamic_plugin_loader.cpp` - åŠ¨æ€åŠ è½½å®ç°
- `platform/include/plugin/framework/plugin_registry.hpp` - æ³¨å†Œè¡¨å®ç°
- `plugins/plugin_loader.cpp` - å†…ç½®æ’ä»¶åŠ è½½

### ç¤ºä¾‹æ’ä»¶

- `plugins/planning/straight_line_planner/` - æœ€ç®€å•çš„ç¤ºä¾‹
- `plugins/planning/astar_planner/` - å®Œæ•´çš„æœç´¢ç®—æ³•ç¤ºä¾‹
- `plugins/perception/grid_map_builder/` - æ„ŸçŸ¥æ’ä»¶ç¤ºä¾‹

