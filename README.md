# NavSim Local - è·¯å¾„è§„åˆ’ä»¿çœŸå¹³å°

NavSim Local æ˜¯ä¸€ä¸ªçµæ´»ã€å¯æ‰©å±•çš„è·¯å¾„è§„åˆ’ç®—æ³•ä»¿çœŸå¹³å°ï¼Œé‡‡ç”¨ä¸‰å±‚è§£è€¦æ¶æ„è®¾è®¡ï¼Œæ”¯æŒå¿«é€Ÿå¼€å‘ã€æµ‹è¯•å’Œå¯¹æ¯”å„ç§è·¯å¾„è§„åˆ’ç®—æ³•ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ—ï¸ ä¸‰å±‚è§£è€¦æ¶æ„**ï¼šç®—æ³•å±‚ã€é€‚é…å±‚ã€å¹³å°å±‚å®Œå…¨åˆ†ç¦»ï¼Œç®—æ³•å¯ç‹¬ç«‹å¤ç”¨
- **ğŸ”Œ æ’ä»¶åŒ–è®¾è®¡**ï¼šæ”¯æŒåŠ¨æ€åŠ è½½å’Œé™æ€é“¾æ¥ï¼Œçµæ´»æ‰©å±•
- **ğŸ› ï¸ å¼€å‘å·¥å…·é½å…¨**ï¼šæ’ä»¶è„šæ‰‹æ¶ã€åœºæ™¯ç”Ÿæˆã€æ€§èƒ½æµ‹è¯•å·¥å…·
- **ğŸš€ å¿«é€Ÿå¼€å‘**ï¼š5 åˆ†é’Ÿåˆ›å»ºæ–°æ’ä»¶ï¼Œä¸“æ³¨ç®—æ³•å®ç°
- **ğŸ§ª ç‹¬ç«‹è¿è¡Œ**ï¼šå®Œæ•´çš„ä»¿çœŸç¯å¢ƒï¼Œå¼€ç®±å³ç”¨
- **ğŸ“Š æ€§èƒ½åˆ†æ**ï¼šæ‰¹é‡æµ‹è¯•å’Œå¯¹æ¯”ä¸åŒç®—æ³•æ€§èƒ½

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
- [å¯ç”¨æ’ä»¶](#å¯ç”¨æ’ä»¶)
- [å¼€å‘å·¥å…·](#å¼€å‘å·¥å…·)
- [æ–‡æ¡£](#æ–‡æ¡£)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¼–è¯‘é¡¹ç›®

```bash
cd navsim-local
mkdir -p build && cd build
cmake ..
make -j4
```

### 2. è¿è¡Œç¤ºä¾‹

```bash
# ä½¿ç”¨ StraightLine è§„åˆ’å™¨
./navsim_local_debug \
  --scenario ../scenarios/simple_corridor.json \
  --planner StraightLinePlanner

# ä½¿ç”¨ A* è§„åˆ’å™¨ï¼ˆéœ€è¦æ …æ ¼åœ°å›¾ï¼‰
./navsim_local_debug \
  --scenario ../scenarios/simple_corridor.json \
  --planner AstarPlanner \
  --perception GridMapBuilder
```

### 3. åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶

```bash
# ä½¿ç”¨è„šæ‰‹æ¶å·¥å…·ç”Ÿæˆæ’ä»¶æ¨¡æ¿
python3 tools/navsim_create_plugin.py \
    --name MyPlanner \
    --type planner \
    --output plugins/planning/my_planner \
    --author "Your Name" \
    --description "My awesome planner"

# å®ç°ç®—æ³•ä»£ç 
# ç¼–è¾‘ plugins/planning/my_planner/algorithm/my_planner.cpp

# ç¼–è¯‘å’Œæµ‹è¯•
cd build
cmake ..
make my_planner_plugin -j4
./navsim_local_debug --planner MyPlanner --scenario ../scenarios/simple_corridor.json
```

è¯¦ç»†æ•™ç¨‹è¯·å‚è€ƒ [æ’ä»¶å¼€å‘æŒ‡å—](docs/PLUGIN_DEVELOPMENT.md)ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### ä¸‰å±‚è§£è€¦æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Platform Layer                        â”‚
â”‚  (å¹³å°å±‚ - æ’ä»¶æ¡†æ¶ã€æ•°æ®ç»“æ„ã€æ¥å£å®šä¹‰)                  â”‚
â”‚  - PlannerPluginInterface                                â”‚
â”‚  - PerceptionPluginInterface                             â”‚
â”‚  - PlanningContext, PlanningResult                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–²
                            â”‚ å®ç°æ¥å£
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Adapter Layer                         â”‚
â”‚  (é€‚é…å±‚ - å¹³å°æ¥å£é€‚é…)                                  â”‚
â”‚  - å®ç°å¹³å°æ’ä»¶æ¥å£                                       â”‚
â”‚  - æ•°æ®æ ¼å¼è½¬æ¢ (å¹³å° â†” ç®—æ³•)                            â”‚
â”‚  - é…ç½®åŠ è½½å’Œå‚æ•°ç®¡ç†                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–²
                            â”‚ è°ƒç”¨ç®—æ³•
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Algorithm Layer                        â”‚
â”‚  (ç®—æ³•å±‚ - çº¯ç®—æ³•å®ç°)                                    â”‚
â”‚  - åªä¾èµ– Eigen + STL                                    â”‚
â”‚  - æ— å¹³å°ä¾èµ–ï¼Œå¯ç‹¬ç«‹æµ‹è¯•                                 â”‚
â”‚  - å¯å¤ç”¨åˆ°å…¶ä»–é¡¹ç›®                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
navsim-local/
â”œâ”€â”€ platform/              # å¹³å°å±‚ä»£ç 
â”‚   â”œâ”€â”€ include/          # å¹³å°å¤´æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ core/        # æ ¸å¿ƒæ•°æ®ç»“æ„
â”‚   â”‚   â””â”€â”€ plugin/      # æ’ä»¶æ¥å£å’Œæ¡†æ¶
â”‚   â””â”€â”€ src/             # å¹³å°å®ç°
â”œâ”€â”€ plugins/              # æ’ä»¶ç›®å½•
â”‚   â”œâ”€â”€ planning/        # è§„åˆ’å™¨æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ straight_line_planner/
â”‚   â”‚   â”œâ”€â”€ astar_planner/
â”‚   â”‚   â””â”€â”€ jps_planner/
â”‚   â””â”€â”€ perception/      # æ„ŸçŸ¥æ’ä»¶
â”‚       â”œâ”€â”€ grid_map_builder/
â”‚       â””â”€â”€ esdf_builder/
â”œâ”€â”€ tools/               # å¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ navsim_create_plugin.py    # æ’ä»¶è„šæ‰‹æ¶å·¥å…·
â”‚   â”œâ”€â”€ navsim_create_scenario.py  # åœºæ™¯ç”Ÿæˆå·¥å…·
â”‚   â””â”€â”€ navsim_benchmark.py        # æ€§èƒ½æµ‹è¯•å·¥å…·
â”œâ”€â”€ scenarios/           # æµ‹è¯•åœºæ™¯
â”œâ”€â”€ apps/               # åº”ç”¨ç¨‹åº
â”‚   â””â”€â”€ navsim_local_debug.cpp    # ä¸»ç¨‹åº
â””â”€â”€ docs/               # æ–‡æ¡£
```

## ğŸ”Œ å¯ç”¨æ’ä»¶

### è§„åˆ’å™¨æ’ä»¶

| æ’ä»¶å | æè¿° | ä¾èµ– | æ€§èƒ½ |
|--------|------|------|------|
| **StraightLinePlanner** | ç›´çº¿è§„åˆ’å™¨ | æ—  | ~0.02 ms |
| **AstarPlanner** | A* è·¯å¾„è§„åˆ’ | OccupancyGrid | ~2-40 ms |
| **JpsPlanner** | Jump Point Search | ESDF Map | ~5-20 ms |

### æ„ŸçŸ¥æ’ä»¶

| æ’ä»¶å | æè¿° | è¾“å‡º |
|--------|------|------|
| **GridMapBuilder** | æ …æ ¼åœ°å›¾æ„å»º | OccupancyGrid |
| **EsdfBuilder** | ESDF åœ°å›¾æ„å»º | ESDFMap |

è¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒå„æ’ä»¶çš„ README.mdã€‚

## ğŸ› ï¸ å¼€å‘å·¥å…·

### 1. æ’ä»¶è„šæ‰‹æ¶å·¥å…·

è‡ªåŠ¨ç”Ÿæˆæ’ä»¶æ¨¡æ¿ä»£ç ï¼ŒåŒ…æ‹¬ç®—æ³•å±‚ã€é€‚é…å±‚ã€CMakeLists.txt å’Œæ–‡æ¡£ã€‚

```bash
python3 tools/navsim_create_plugin.py \
    --name MyPlanner \
    --type planner \
    --output plugins/planning/my_planner
```

### 2. åœºæ™¯ç”Ÿæˆå·¥å…·

äº¤äº’å¼åˆ›å»ºæµ‹è¯•åœºæ™¯ï¼Œæ”¯æŒæ·»åŠ éšœç¢ç‰©ã€åŠ¨æ€éšœç¢ç‰©ç­‰ã€‚

```bash
python3 tools/navsim_create_scenario.py \
    --output scenarios/my_scenario.json \
    --interactive
```

### 3. æ€§èƒ½æµ‹è¯•å·¥å…·

æ‰¹é‡æµ‹è¯•å¤šä¸ªåœºæ™¯å’Œè§„åˆ’å™¨ï¼Œç”Ÿæˆæ€§èƒ½å¯¹æ¯”æŠ¥å‘Šã€‚

```bash
python3 tools/navsim_benchmark.py \
    --scenarios scenarios/*.json \
    --planners AstarPlanner,JpsPlanner \
    --output benchmark_results.json
```

è¯¦ç»†ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒ [å¼€å‘å·¥å…·æŒ‡å—](docs/DEVELOPMENT_TOOLS.md)ã€‚

## ğŸ“š æ–‡æ¡£

- **[å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/GETTING_STARTED.md)** - ç¼–è¯‘ã€è¿è¡Œã€åŸºæœ¬ä½¿ç”¨
- **[æ’ä»¶å¼€å‘æŒ‡å—](docs/PLUGIN_DEVELOPMENT.md)** - å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶
- **[å¼€å‘å·¥å…·æŒ‡å—](docs/DEVELOPMENT_TOOLS.md)** - è„šæ‰‹æ¶ã€åœºæ™¯ç”Ÿæˆã€æ€§èƒ½æµ‹è¯•
- **[æ¶æ„è®¾è®¡æ–‡æ¡£](docs/ARCHITECTURE.md)** - è¯¦ç»†çš„æ¶æ„è®¾è®¡å’Œå®ç°

## ğŸ”§ æŠ€æœ¯æ ˆ

- **C++17** - ä¸»è¦ç¼–ç¨‹è¯­è¨€
- **CMake 3.16+** - æ„å»ºç³»ç»Ÿ
- **Eigen3** - çº¿æ€§ä»£æ•°åº“
- **nlohmann/json** - JSON è§£æï¼ˆheader-onlyï¼‰
- **Python 3** - å¼€å‘å·¥å…·
- **dlopen/dlsym** - åŠ¨æ€æ’ä»¶åŠ è½½

## ğŸ“¦ ä¾èµ–å®‰è£…

### Ubuntu/Debian

```bash
sudo apt-get update
sudo apt-get install -y \
    build-essential \
    cmake \
    libeigen3-dev \
    python3 \
    python3-pip
```

### macOS

```bash
brew install cmake eigen
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®æ–°çš„è§„åˆ’ç®—æ³•æ’ä»¶ï¼è¯·å‚è€ƒ [æ’ä»¶å¼€å‘æŒ‡å—](docs/PLUGIN_DEVELOPMENT.md)ã€‚

## ğŸ“„ è®¸å¯è¯

[å¾…å®š]
